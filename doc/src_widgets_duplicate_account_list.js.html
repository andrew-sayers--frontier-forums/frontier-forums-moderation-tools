<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Source: src/widgets/duplicate_account_list.js</title>


    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">


    <script>
    var config = {"monospaceLinks":false,"cleverLinks":true,"default":{"outputSourceFiles":true}};
    </script>



</head>
<body>
<div id="wrap" class="clearfix">

<div class="navigation">
    <h3 class="applicationName"><a href="index.html"></a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">

        <li class="item" data-name="AccountHighlighter">
            <span class="title">
                <a href="AccountHighlighter.html">AccountHighlighter</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="AccountHighlighter#highlight"><a href="AccountHighlighter.html#highlight">highlight</a></li>

                <li data-name="AccountHighlighter#highlight_to_element"><a href="AccountHighlighter.html#highlight_to_element">highlight_to_element</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="Action">
            <span class="title">
                <a href="Action.html">Action</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="Action#blockers"><a href="Action.html#blockers">blockers</a></li>

                <li data-name="Action#fire"><a href="Action.html#fire">fire</a></li>

                <li data-name="Action#fire_with_journal"><a href="Action.html#fire_with_journal">fire_with_journal</a></li>

                <li data-name="Action#long_description"><a href="Action.html#long_description">long_description</a></li>

                <li data-name="Action#then"><a href="Action.html#then">then</a></li>

                <li data-name="Action#title"><a href="Action.html#title">title</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="ActionWidget">
            <span class="title">
                <a href="ActionWidget.html">ActionWidget</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="ActionWidget#action"><a href="ActionWidget.html#action">action</a></li>

                <li data-name="ActionWidget#reset_value"><a href="ActionWidget.html#reset_value">reset_value</a></li>

                <li data-name="ActionWidget#resolve_value"><a href="ActionWidget.html#resolve_value">resolve_value</a></li>

                <li data-name="ActionWidget#set_value"><a href="ActionWidget.html#set_value">set_value</a></li>

                <li data-name="ActionWidget#update_previous_values"><a href="ActionWidget.html#update_previous_values">update_previous_values</a></li>

                <li data-name="ActionWidget#val"><a href="ActionWidget.html#val">val</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="AvailableUsers">
            <span class="title">
                <a href="AvailableUsers.html">AvailableUsers</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="AvailableUsers#active"><a href="AvailableUsers.html#active">active</a></li>

                <li data-name="AvailableUsers#is_ours"><a href="AvailableUsers.html#is_ours">is_ours</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="BulletinBoard">
            <span class="title">
                <a href="BulletinBoard.html">BulletinBoard</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="BulletinBoard#_add_standard_data"><a href="BulletinBoard.html#_add_standard_data">_add_standard_data</a></li>

                <li data-name="BulletinBoard#build_url"><a href="BulletinBoard.html#build_url">build_url</a></li>

                <li data-name="BulletinBoard#config"><a href="BulletinBoard.html#config">config</a></li>

                <li data-name="BulletinBoard#detect_post_error"><a href="BulletinBoard.html#detect_post_error">detect_post_error</a></li>

                <li data-name="BulletinBoard#fix_url"><a href="BulletinBoard.html#fix_url">fix_url</a></li>

                <li data-name="BulletinBoard#get"><a href="BulletinBoard.html#get">get</a></li>

                <li data-name="BulletinBoard#get_pages"><a href="BulletinBoard.html#get_pages">get_pages</a></li>

                <li data-name="BulletinBoard#get_posts"><a href="BulletinBoard.html#get_posts">get_posts</a></li>

                <li data-name="BulletinBoard#parse"><a href="BulletinBoard.html#parse">parse</a></li>

                <li data-name="BulletinBoard#parse_post"><a href="BulletinBoard.html#parse_post">parse_post</a></li>

                <li data-name="BulletinBoard#ping"><a href="BulletinBoard.html#ping">ping</a></li>

                <li data-name="BulletinBoard#post"><a href="BulletinBoard.html#post">post</a></li>

                <li data-name="BulletinBoard#process_posts"><a href="BulletinBoard.html#process_posts">process_posts</a></li>

                <li data-name="BulletinBoard#quotes_process"><a href="BulletinBoard.html#quotes_process">quotes_process</a></li>

                <li data-name="BulletinBoard#stringify"><a href="BulletinBoard.html#stringify">stringify</a></li>

                <li data-name="BulletinBoard#thread_posts"><a href="BulletinBoard.html#thread_posts">thread_posts</a></li>

                <li data-name="BulletinBoard#user_duplicates"><a href="BulletinBoard.html#user_duplicates">user_duplicates</a></li>

                <li data-name="BulletinBoard#when"><a href="BulletinBoard.html#when">when</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="Cacheable">
            <span class="title">
                <a href="Cacheable.html">Cacheable</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="Cacheable#refresh"><a href="Cacheable.html#refresh">refresh</a></li>

                <li data-name="Cacheable#update_cache"><a href="Cacheable.html#update_cache">update_cache</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="Collapse">
            <span class="title">
                <a href="Collapse.html">Collapse</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="Collapse#val"><a href="Collapse.html#val">val</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="Dashboard">
            <span class="title">
                <a href="Dashboard.html">Dashboard</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="Dashboard#refresh"><a href="Dashboard.html#refresh">refresh</a></li>

                <li data-name="Dashboard#update_cache"><a href="Dashboard.html#update_cache">update_cache</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="Deadline">
            <span class="title">
                <a href="Deadline.html">Deadline</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="Deadline#action"><a href="Deadline.html#action">action</a></li>

                <li data-name="Deadline#reset_value"><a href="Deadline.html#reset_value">reset_value</a></li>

                <li data-name="Deadline#resolve_value"><a href="Deadline.html#resolve_value">resolve_value</a></li>

                <li data-name="Deadline#set_value"><a href="Deadline.html#set_value">set_value</a></li>

                <li data-name="Deadline#update_previous_values"><a href="Deadline.html#update_previous_values">update_previous_values</a></li>

                <li data-name="Deadline#val"><a href="Deadline.html#val">val</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="DuplicateAccountList">
            <span class="title">
                <a href="DuplicateAccountList.html">DuplicateAccountList</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="DuplicateAccountList#_heatmap"><a href="DuplicateAccountList.html#_heatmap">_heatmap</a></li>

                <li data-name="DuplicateAccountList#val"><a href="DuplicateAccountList.html#val">val</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="DuplicateAccountPolicy">
            <span class="title">
                <a href="DuplicateAccountPolicy.html">DuplicateAccountPolicy</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="DuplicateAccountPolicy#_Single">
            <span class="title">
                <a href="DuplicateAccountPolicy__Single.html">DuplicateAccountPolicy#_Single</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="ExtraPost">
            <span class="title">
                <a href="ExtraPost.html">ExtraPost</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="ExtraPost#action"><a href="ExtraPost.html#action">action</a></li>

                <li data-name="ExtraPost#reset_value"><a href="ExtraPost.html#reset_value">reset_value</a></li>

                <li data-name="ExtraPost#resolve_value"><a href="ExtraPost.html#resolve_value">resolve_value</a></li>

                <li data-name="ExtraPost#set_value"><a href="ExtraPost.html#set_value">set_value</a></li>

                <li data-name="ExtraPost#update_previous_values"><a href="ExtraPost.html#update_previous_values">update_previous_values</a></li>

                <li data-name="ExtraPost#val"><a href="ExtraPost.html#val">val</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="Help">
            <span class="title">
                <a href="Help.html">Help</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="Help#val"><a href="Help.html#val">val</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="InappropriateUsernamePolicy">
            <span class="title">
                <a href="InappropriateUsernamePolicy.html">InappropriateUsernamePolicy</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="IPAddressReport">
            <span class="title">
                <a href="IPAddressReport.html">IPAddressReport</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="IPAddressReport#action"><a href="IPAddressReport.html#action">action</a></li>

                <li data-name="IPAddressReport#bbcode"><a href="IPAddressReport.html#bbcode">bbcode</a></li>

                <li data-name="IPAddressReport#cache_timeout"><a href="IPAddressReport.html#cache_timeout">cache_timeout</a></li>

                <li data-name="IPAddressReport#html"><a href="IPAddressReport.html#html">html</a></li>

                <li data-name="IPAddressReport#users"><a href="IPAddressReport.html#users">users</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="MiscellaneousCache">
            <span class="title">
                <a href="MiscellaneousCache.html">MiscellaneousCache</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="MiscellaneousCache#refresh"><a href="MiscellaneousCache.html#refresh">refresh</a></li>

                <li data-name="MiscellaneousCache#update_cache"><a href="MiscellaneousCache.html#update_cache">update_cache</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="NotificationSelector">
            <span class="title">
                <a href="NotificationSelector.html">NotificationSelector</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="NotificationSelector#action"><a href="NotificationSelector.html#action">action</a></li>

                <li data-name="NotificationSelector#add_known_keys"><a href="NotificationSelector.html#add_known_keys">add_known_keys</a></li>

                <li data-name="NotificationSelector#extra_block"><a href="NotificationSelector.html#extra_block">extra_block</a></li>

                <li data-name="NotificationSelector#mode"><a href="NotificationSelector.html#mode">mode</a></li>

                <li data-name="NotificationSelector#mode_switcher"><a href="NotificationSelector.html#mode_switcher">mode_switcher</a></li>

                <li data-name="NotificationSelector#reset_value"><a href="NotificationSelector.html#reset_value">reset_value</a></li>

                <li data-name="NotificationSelector#resolve_value"><a href="NotificationSelector.html#resolve_value">resolve_value</a></li>

                <li data-name="NotificationSelector#set_value"><a href="NotificationSelector.html#set_value">set_value</a></li>

                <li data-name="NotificationSelector#update_previous_values"><a href="NotificationSelector.html#update_previous_values">update_previous_values</a></li>

                <li data-name="NotificationSelector#val"><a href="NotificationSelector.html#val">val</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="Policy">
            <span class="title">
                <a href="Policy.html">Policy</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="Policy#_build_keys"><a href="Policy.html#_build_keys">_build_keys</a></li>

                <li data-name="Policy#_build_widget_args"><a href="Policy.html#_build_widget_args">_build_widget_args</a></li>

                <li data-name="Policy#check"><a href="Policy.html#check">check</a></li>

                <li data-name="Policy#close_thread"><a href="Policy.html#close_thread">close_thread</a></li>

                <li data-name="Policy#deadline_action"><a href="Policy.html#deadline_action">deadline_action</a></li>

                <li data-name="Policy#deadline_args"><a href="Policy.html#deadline_args">deadline_args</a></li>

                <li data-name="Policy#duplicate_account_list_args"><a href="Policy.html#duplicate_account_list_args">duplicate_account_list_args</a></li>

                <li data-name="Policy#extra_post_action"><a href="Policy.html#extra_post_action">extra_post_action</a></li>

                <li data-name="Policy#extra_post_args"><a href="Policy.html#extra_post_args">extra_post_args</a></li>

                <li data-name="Policy#get"><a href="Policy.html#get">get</a></li>

                <li data-name="Policy#keys"><a href="Policy.html#keys">keys</a></li>

                <li data-name="Policy#notification_selector_action"><a href="Policy.html#notification_selector_action">notification_selector_action</a></li>

                <li data-name="Policy#notification_selector_args"><a href="Policy.html#notification_selector_args">notification_selector_args</a></li>

                <li data-name="Policy#resolve"><a href="Policy.html#resolve">resolve</a></li>

                <li data-name="Policy#resolve_post"><a href="Policy.html#resolve_post">resolve_post</a></li>

                <li data-name="Policy#severity_slider_args"><a href="Policy.html#severity_slider_args">severity_slider_args</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="RecentList">
            <span class="title">
                <a href="RecentList.html">RecentList</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="RecentList#get"><a href="RecentList.html#get">get</a></li>

                <li data-name="RecentList#push"><a href="RecentList.html#push">push</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="Report">
            <span class="title">
                <a href="Report.html">Report</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="SeveritySlider">
            <span class="title">
                <a href="SeveritySlider.html">SeveritySlider</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="SeveritySlider#val"><a href="SeveritySlider.html#val">val</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="SharedStore">
            <span class="title">
                <a href="SharedStore.html">SharedStore</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="SharedStore#change"><a href="SharedStore.html#change">change</a></li>

                <li data-name="SharedStore#interval_transaction"><a href="SharedStore.html#interval_transaction">interval_transaction</a></li>

                <li data-name="SharedStore#transaction"><a href="SharedStore.html#transaction">transaction</a></li>

                <li data-name="SharedStore#val"><a href="SharedStore.html#val">val</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="ThreadManagementPolicy">
            <span class="title">
                <a href="ThreadManagementPolicy.html">ThreadManagementPolicy</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="ThreadManagementPolicy#unmerge_action"><a href="ThreadManagementPolicy.html#unmerge_action">unmerge_action</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="ThreadTitleSelector">
            <span class="title">
                <a href="ThreadTitleSelector.html">ThreadTitleSelector</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="ThreadTitleSelector#check"><a href="ThreadTitleSelector.html#check">check</a></li>

                <li data-name="ThreadTitleSelector#focus"><a href="ThreadTitleSelector.html#focus">focus</a></li>

                <li data-name="ThreadTitleSelector#val"><a href="ThreadTitleSelector.html#val">val</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="Variables">
            <span class="title">
                <a href="Variables.html">Variables</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="Variables#check"><a href="Variables.html#check">check</a></li>

                <li data-name="Variables#escape"><a href="Variables.html#escape">escape</a></li>

                <li data-name="Variables#get"><a href="Variables.html#get">get</a></li>

                <li data-name="Variables#get_language"><a href="Variables.html#get_language">get_language</a></li>

                <li data-name="Variables#parse"><a href="Variables.html#parse">parse</a></li>

                <li data-name="Variables#refresh"><a href="Variables.html#refresh">refresh</a></li>

                <li data-name="Variables#resolve"><a href="Variables.html#resolve">resolve</a></li>

                <li data-name="Variables#set_namespaces"><a href="Variables.html#set_namespaces">set_namespaces</a></li>

                <li data-name="Variables#update_cache"><a href="Variables.html#update_cache">update_cache</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="VariablesFromFirstPost">
            <span class="title">
                <a href="VariablesFromFirstPost.html">VariablesFromFirstPost</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="VariablesFromFirstPost#check"><a href="VariablesFromFirstPost.html#check">check</a></li>

                <li data-name="VariablesFromFirstPost#escape"><a href="VariablesFromFirstPost.html#escape">escape</a></li>

                <li data-name="VariablesFromFirstPost#get"><a href="VariablesFromFirstPost.html#get">get</a></li>

                <li data-name="VariablesFromFirstPost#get_language"><a href="VariablesFromFirstPost.html#get_language">get_language</a></li>

                <li data-name="VariablesFromFirstPost#parse"><a href="VariablesFromFirstPost.html#parse">parse</a></li>

                <li data-name="VariablesFromFirstPost#refresh"><a href="VariablesFromFirstPost.html#refresh">refresh</a></li>

                <li data-name="VariablesFromFirstPost#resolve"><a href="VariablesFromFirstPost.html#resolve">resolve</a></li>

                <li data-name="VariablesFromFirstPost#set_namespaces"><a href="VariablesFromFirstPost.html#set_namespaces">set_namespaces</a></li>

                <li data-name="VariablesFromFirstPost#update_cache"><a href="VariablesFromFirstPost.html#update_cache">update_cache</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="VariablesFromForum">
            <span class="title">
                <a href="VariablesFromForum.html">VariablesFromForum</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="VariablesFromForum#check"><a href="VariablesFromForum.html#check">check</a></li>

                <li data-name="VariablesFromForum#escape"><a href="VariablesFromForum.html#escape">escape</a></li>

                <li data-name="VariablesFromForum#get"><a href="VariablesFromForum.html#get">get</a></li>

                <li data-name="VariablesFromForum#get_language"><a href="VariablesFromForum.html#get_language">get_language</a></li>

                <li data-name="VariablesFromForum#parse"><a href="VariablesFromForum.html#parse">parse</a></li>

                <li data-name="VariablesFromForum#refresh"><a href="VariablesFromForum.html#refresh">refresh</a></li>

                <li data-name="VariablesFromForum#refresh_thread"><a href="VariablesFromForum.html#refresh_thread">refresh_thread</a></li>

                <li data-name="VariablesFromForum#resolve"><a href="VariablesFromForum.html#resolve">resolve</a></li>

                <li data-name="VariablesFromForum#serialise_thread"><a href="VariablesFromForum.html#serialise_thread">serialise_thread</a></li>

                <li data-name="VariablesFromForum#set_namespaces"><a href="VariablesFromForum.html#set_namespaces">set_namespaces</a></li>

                <li data-name="VariablesFromForum#update_cache"><a href="VariablesFromForum.html#update_cache">update_cache</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="VBulletin">
            <span class="title">
                <a href="VBulletin.html">VBulletin</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="VBulletin.iframe_callbacks"><a href="VBulletin.html#.iframe_callbacks">iframe_callbacks</a></li>

                <li data-name="VBulletin#_add_standard_data"><a href="VBulletin.html#_add_standard_data">_add_standard_data</a></li>

                <li data-name="VBulletin#activity"><a href="VBulletin.html#activity">activity</a></li>

                <li data-name="VBulletin#attachments_delete"><a href="VBulletin.html#attachments_delete">attachments_delete</a></li>

                <li data-name="VBulletin#bbcode_html"><a href="VBulletin.html#bbcode_html">bbcode_html</a></li>

                <li data-name="VBulletin#bbcode_html_newthread"><a href="VBulletin.html#bbcode_html_newthread">bbcode_html_newthread</a></li>

                <li data-name="VBulletin#build_url"><a href="VBulletin.html#build_url">build_url</a></li>

                <li data-name="VBulletin#check_login"><a href="VBulletin.html#check_login">check_login</a></li>

                <li data-name="VBulletin#config"><a href="VBulletin.html#config">config</a></li>

                <li data-name="VBulletin#css_add"><a href="VBulletin.html#css_add">css_add</a></li>

                <li data-name="VBulletin#css_keys"><a href="VBulletin.html#css_keys">css_keys</a></li>

                <li data-name="VBulletin#date_parser"><a href="VBulletin.html#date_parser">date_parser</a></li>

                <li data-name="VBulletin#detect_post_error"><a href="VBulletin.html#detect_post_error">detect_post_error</a></li>

                <li data-name="VBulletin#editor_get"><a href="VBulletin.html#editor_get">editor_get</a></li>

                <li data-name="VBulletin#editor_set"><a href="VBulletin.html#editor_set">editor_set</a></li>

                <li data-name="VBulletin#fix_url"><a href="VBulletin.html#fix_url">fix_url</a></li>

                <li data-name="VBulletin#folder_pms"><a href="VBulletin.html#folder_pms">folder_pms</a></li>

                <li data-name="VBulletin#forum_metadata"><a href="VBulletin.html#forum_metadata">forum_metadata</a></li>

                <li data-name="VBulletin#forum_threads"><a href="VBulletin.html#forum_threads">forum_threads</a></li>

                <li data-name="VBulletin#forums"><a href="VBulletin.html#forums">forums</a></li>

                <li data-name="VBulletin#get"><a href="VBulletin.html#get">get</a></li>

                <li data-name="VBulletin#get_pages"><a href="VBulletin.html#get_pages">get_pages</a></li>

                <li data-name="VBulletin#get_posts"><a href="VBulletin.html#get_posts">get_posts</a></li>

                <li data-name="VBulletin#infraction_give"><a href="VBulletin.html#infraction_give">infraction_give</a></li>

                <li data-name="VBulletin#infraction_give_custom"><a href="VBulletin.html#infraction_give_custom">infraction_give_custom</a></li>

                <li data-name="VBulletin#infraction_ids"><a href="VBulletin.html#infraction_ids">infraction_ids</a></li>

                <li data-name="VBulletin#ip_users"><a href="VBulletin.html#ip_users">ip_users</a></li>

                <li data-name="VBulletin#login"><a href="VBulletin.html#login">login</a></li>

                <li data-name="VBulletin#login_auto"><a href="VBulletin.html#login_auto">login_auto</a></li>

                <li data-name="VBulletin#moderation_page"><a href="VBulletin.html#moderation_page">moderation_page</a></li>

                <li data-name="VBulletin#on_posts_modified"><a href="VBulletin.html#on_posts_modified">on_posts_modified</a></li>

                <li data-name="VBulletin#parse"><a href="VBulletin.html#parse">parse</a></li>

                <li data-name="VBulletin#parse_post"><a href="VBulletin.html#parse_post">parse_post</a></li>

                <li data-name="VBulletin#ping"><a href="VBulletin.html#ping">ping</a></li>

                <li data-name="VBulletin#pm_send"><a href="VBulletin.html#pm_send">pm_send</a></li>

                <li data-name="VBulletin#post"><a href="VBulletin.html#post">post</a></li>

                <li data-name="VBulletin#post_create"><a href="VBulletin.html#post_create">post_create</a></li>

                <li data-name="VBulletin#post_delete"><a href="VBulletin.html#post_delete">post_delete</a></li>

                <li data-name="VBulletin#post_edit"><a href="VBulletin.html#post_edit">post_edit</a></li>

                <li data-name="VBulletin#post_info"><a href="VBulletin.html#post_info">post_info</a></li>

                <li data-name="VBulletin#post_report"><a href="VBulletin.html#post_report">post_report</a></li>

                <li data-name="VBulletin#post_summary"><a href="VBulletin.html#post_summary">post_summary</a></li>

                <li data-name="VBulletin#posts_moderated"><a href="VBulletin.html#posts_moderated">posts_moderated</a></li>

                <li data-name="VBulletin#posts_move"><a href="VBulletin.html#posts_move">posts_move</a></li>

                <li data-name="VBulletin#process_posts"><a href="VBulletin.html#process_posts">process_posts</a></li>

                <li data-name="VBulletin#quotes_process"><a href="VBulletin.html#quotes_process">quotes_process</a></li>

                <li data-name="VBulletin#redirect_modcp_ipsearch"><a href="VBulletin.html#redirect_modcp_ipsearch">redirect_modcp_ipsearch</a></li>

                <li data-name="VBulletin#server_stats"><a href="VBulletin.html#server_stats">server_stats</a></li>

                <li data-name="VBulletin#spammer_delete"><a href="VBulletin.html#spammer_delete">spammer_delete</a></li>

                <li data-name="VBulletin#stringify"><a href="VBulletin.html#stringify">stringify</a></li>

                <li data-name="VBulletin#thread_bump"><a href="VBulletin.html#thread_bump">thread_bump</a></li>

                <li data-name="VBulletin#thread_create"><a href="VBulletin.html#thread_create">thread_create</a></li>

                <li data-name="VBulletin#thread_debump"><a href="VBulletin.html#thread_debump">thread_debump</a></li>

                <li data-name="VBulletin#thread_delete"><a href="VBulletin.html#thread_delete">thread_delete</a></li>

                <li data-name="VBulletin#thread_edit"><a href="VBulletin.html#thread_edit">thread_edit</a></li>

                <li data-name="VBulletin#thread_merge"><a href="VBulletin.html#thread_merge">thread_merge</a></li>

                <li data-name="VBulletin#thread_metadata"><a href="VBulletin.html#thread_metadata">thread_metadata</a></li>

                <li data-name="VBulletin#thread_move"><a href="VBulletin.html#thread_move">thread_move</a></li>

                <li data-name="VBulletin#thread_openclose"><a href="VBulletin.html#thread_openclose">thread_openclose</a></li>

                <li data-name="VBulletin#thread_posts"><a href="VBulletin.html#thread_posts">thread_posts</a></li>

                <li data-name="VBulletin#thread_reply"><a href="VBulletin.html#thread_reply">thread_reply</a></li>

                <li data-name="VBulletin#thread_title"><a href="VBulletin.html#thread_title">thread_title</a></li>

                <li data-name="VBulletin#thread_whoposted"><a href="VBulletin.html#thread_whoposted">thread_whoposted</a></li>

                <li data-name="VBulletin#threads_complete"><a href="VBulletin.html#threads_complete">threads_complete</a></li>

                <li data-name="VBulletin#threads_recent"><a href="VBulletin.html#threads_recent">threads_recent</a></li>

                <li data-name="VBulletin#url_decode"><a href="VBulletin.html#url_decode">url_decode</a></li>

                <li data-name="VBulletin#user_ban"><a href="VBulletin.html#user_ban">user_ban</a></li>

                <li data-name="VBulletin#user_current"><a href="VBulletin.html#user_current">user_current</a></li>

                <li data-name="VBulletin#user_duplicates"><a href="VBulletin.html#user_duplicates">user_duplicates</a></li>

                <li data-name="VBulletin#user_info"><a href="VBulletin.html#user_info">user_info</a></li>

                <li data-name="VBulletin#user_ips"><a href="VBulletin.html#user_ips">user_ips</a></li>

                <li data-name="VBulletin#user_moderation_info"><a href="VBulletin.html#user_moderation_info">user_moderation_info</a></li>

                <li data-name="VBulletin#user_notes"><a href="VBulletin.html#user_notes">user_notes</a></li>

                <li data-name="VBulletin#user_overlapping"><a href="VBulletin.html#user_overlapping">user_overlapping</a></li>

                <li data-name="VBulletin#user_posts"><a href="VBulletin.html#user_posts">user_posts</a></li>

                <li data-name="VBulletin#user_signature_get"><a href="VBulletin.html#user_signature_get">user_signature_get</a></li>

                <li data-name="VBulletin#user_signature_set"><a href="VBulletin.html#user_signature_set">user_signature_set</a></li>

                <li data-name="VBulletin#usernote_add"><a href="VBulletin.html#usernote_add">usernote_add</a></li>

                <li data-name="VBulletin#usernote_edit"><a href="VBulletin.html#usernote_edit">usernote_edit</a></li>

                <li data-name="VBulletin#usernote_info"><a href="VBulletin.html#usernote_info">usernote_info</a></li>

                <li data-name="VBulletin#users_complete"><a href="VBulletin.html#users_complete">users_complete</a></li>

                <li data-name="VBulletin#users_list_new"><a href="VBulletin.html#users_list_new">users_list_new</a></li>

                <li data-name="VBulletin#when"><a href="VBulletin.html#when">when</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="VbulletinPopupMenu">
            <span class="title">
                <a href="VbulletinPopupMenu.html">VbulletinPopupMenu</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="VbulletinPopupMenu#val"><a href="VbulletinPopupMenu.html#val">val</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="Violations">
            <span class="title">
                <a href="Violations.html">Violations</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="Violations#refresh"><a href="Violations.html#refresh">refresh</a></li>

                <li data-name="Violations#update_cache"><a href="Violations.html#update_cache">update_cache</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

        <li class="item" data-name="Widget">
            <span class="title">
                <a href="Widget.html">Widget</a>

            </span>
            <ul class="members itemMembers">

            </ul>
            <ul class="typedefs itemMembers">

            </ul>
            <ul class="methods itemMembers">

            <span class="subtitle">Methods</span>

                <li data-name="Widget#val"><a href="Widget.html#val">val</a></li>

            </ul>
            <ul class="events itemMembers">

            </ul>
        </li>

    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="src_widgets_duplicate_account_list.js.html">Source: src/widgets/duplicate_account_list.js</h1>




    <section>
        <article>
            <pre class="prettyprint source "><code>/**
 * @file Duplicate username list
 * @author Andrew Sayers
 * @summary Select a list of accounts you believe to be duplicates for the same user
 */

/**
 * @summary Select a list of accounts you believe to be duplicates for the same user
 * @constructor
 * @extends Widget
 * @param {Object} args duplicate account arguments
 * @example
 *
 * var dupe_list = new DuplicateAccountList({
 *
 *     required: [{ username: ..., user_id: ..., email: ..., notes: ... }, ...], // Accounts that must be included in the list
 *     default : [{ username: ..., user_id: ..., email: ..., notes: ... }, ...], // Accounts that will be suggested by default
 *
 *     show_heatmap: false, // if true, the "required" and "default" lists must include info and mod_info
 *
 *     // other data needed for the list to function:
 *     bb          : bb, // BulletinBoard object
 *     v           : v, // Variables object
 *     callback    : function(users) { ... }, // called with the current data
 *     container   : dupes_appended_to_this,
 *     loading_html: 'loading...',
 *
 * });
 */
function DuplicateAccountList( args ) {

    // we need to handle the callback specially:
    var callback = args.callback;
    delete args.callback;

    Widget.call( this, args, 'duplicate_account_list' );

    if ( !DuplicateAccountList.css_added ) {
        DuplicateAccountList.css_added = true;
        $("head").append(
            "&lt;style type='text/css'>" +
                args.v.parse( BabelExt.resources.get('res/widgets/duplicate_account_list.css'), args.bb.css_keys() ) +
            "&lt;/style>"
        );
    }

    var dupes = this;

    this.bb           = args.bb;
    this.v            = args.v;
    this.user_info    = {};
    this.show_heatmap = args.show_heatmap;
    this.loading_html = args.loading_html;
    this.li_template  = this.element.find('li').detach();
    if ( args.required &amp;&amp; args.required.length ) {
        this.account_highlighter = new AccountHighlighter({ v: args.v, source_username: args.required[0].username.replace( /\s/g, '\u00A0' ), source_address: args.required[0].email });
    } else {
        this.account_highlighter = new AccountHighlighter({ v: args.v, source_username: '', source_address: '@' });
    }

    if ( this.show_heatmap ) this.element.addClass('heatmap');

    // make sure there's a &lt;datalist> for us:
    var list_id = this.element.find('.user').attr('list');
    if ( $('#'+list_id).length == 0 ) {
        $('&lt;datalist id="' + list_id + '">&lt;option>&lt;/option>&lt;/datalist>').appendTo(document.body);
    }

    this.val(args);

    var primary_user_id = args.required ? args.required[0].user_id : 0, old_list_length = -1;

    var user_table = this.element.children('table');
    form_keys( args.bb, user_table, function(keys, list) {
        var callback_needed = false, callback_list = [];
        if ( !user_table.find('[name="primary-username"]:checked').length )
            user_table.find('[name="primary-username"]').first().prop( 'checked', true );
        var new_primary_user_id = user_table.find('[name="primary-username"]:checked').closest('tr').data('dupe-account-current');
        if ( primary_user_id != new_primary_user_id ) {
            primary_user_id = new_primary_user_id;
            callback_needed = true;
        }
        list.forEach(function(item) {
            var row = $(item.element).closest('tr');
            if ( item.value ) {
                row.removeClass('dupe-unknown');
                callback_needed |= dupes._set_row( row, $.trim(item.text), item.value );
                callback_list.push( row.data('dupe-account-val') );
                callback_list[callback_list.length-1].is_primary = callback_list[callback_list.length-1].user_id == primary_user_id;
            } else {
                row.   addClass('dupe-unknown');
            }
        });
        if ( old_list_length != list.length ) {
            old_list_length = list.length;
            callback_needed = true;
        }
        if ( callback_needed &amp;&amp; callback ) {
            callback(
                $(user_table).find('.required').map(function() {
                    var ret = $(this).data('dupe-account-val');
                    ret.is_primary = ret.user_id == primary_user_id;
                    return ret;
                }).get().concat( callback_list )
            );
        }
        return false; // prevent form submission
    });

    // INITIALISE THE POPUP

    var popup = this.element.find('.timeline-popup');
    function hide_popup() {
        if ( !$(this).closest('.timeline-popup').length ) {
            popup.hide();
            $(document.body).off( 'click', hide_popup );
        }
    };
    popup.find('.close').click(function(event) {
        popup.hide();
        $(document.body).off( 'click', hide_popup );
        event.preventDefault();
    });
    popup.on( 'click', 'a', function(event) {
        this.href.replace( /#event-[0-9]*/, function(event) {
            $(event).data('collapse').val(false);
        });
    });

    this.element.find('.timeline').on( 'click', 'a.mod-team-events', function(event) {
        var $this = $(this);

        popup.find('.header span:first-child').text($this.attr('title'));
        popup.find('.body').children().detach();
        popup.find('.body').append($this.data('popup-body'));

        var position = $this.position();
        position.top += $this.outerHeight();
        popup.css(position).show();
        setTimeout(function() { $(document.body).click(hide_popup) }, 0);

        event.preventDefault();
    });

}

DuplicateAccountList.prototype = Object.create(Widget, {
    bb                 : { writable: true, configurable: false },
    v                  : { writable: true, configurable: false },
    user_info          : { writable: true, configurable: false },
    account_highlighter: { writable: true, configurable: false },
    loading_html       : { writable: true, configurable: false },
    li_template        : { writable: true, configurable: false },
});
DuplicateAccountList.prototype.constructor = DuplicateAccountList;

// Set the elements in a &lt;tr>, return true if the element has changed value:
DuplicateAccountList.prototype._set_row = function( row, username, user_id, first_user ) {

    row.find('.member').attr( 'href', this.bb.url_for.user_show({ user_id: user_id }) );

    if ( row.data('dupe-account-current') == user_id ) return false;

    if ( this.user_info.hasOwnProperty(user_id) ) {

        var user = this.user_info[user_id];
        if ( this.show_heatmap ) {
            row.find('.heatmap').html( this.loading_html );
            var dupes = this;
            $.when( user.post_promise, user.note_promise ).then(function(posts, notes) { dupes._heatmap( row.find('.heatmap'), user.info, posts, notes ) });
        }
        row
            .data('dupe-account-current', user_id)
            .removeClass( 'dupe-loading' );
        row.find('.email-user a,.at a,.email-domain a'  ).attr( 'href', 'mailto:' + user.email );
        row.find( '.notes' ).html( user.notes ).find('time').timeago();
        if ( first_user ) {
            var email = user.email.split('@');
            row.find('.member'        )        .text( username.replace( /\s/g, '\u00A0' ) );
            row.find('.email-user a'  )        .text( email[0] );
            row.find('.email-domain a').first().text( email[1] );
        } else {
            this.account_highlighter.highlight_to_element(
                username.replace( /\s/g, '\u00A0' ),
                user.email,
                row.find('.member'),
                row.find('.email-user a'  ),
                row.find('.email-domain a').first()
            );
        }

    } else {

        var dupes = this;
        row.addClass( 'dupe-loading' );
        var post_promise = this.show_heatmap &amp;&amp; this.bb.user_posts(user_id, true);
        var note_promise = this.show_heatmap &amp;&amp; this.bb.user_notes(user_id);
        $.when(
            this.bb.user_info(user_id),
            this.bb.user_moderation_info(user_id)
        ).then(function( user_info, user_moderation_info ) {
            dupes.user_info[user_id] = {
                email: user_moderation_info.email,
                notes: user_info.infraction_summary + ' ' + user_moderation_info.summary,
                info: user_info,
                moderation_info: user_moderation_info,
                post_promise: post_promise,
                note_promise: note_promise,

            };
            dupes._set_row( row, username, user_id );
        });

    }

    row.data( 'dupe-account-val', { username: username, user_id: user_id } );

    return true;

}

/**
 * @summary Get/set widget's values
 * @param {Object} value new value
 * @return {Object} (new) value
 * @example
 *
 * ns.val({
 *     required: [{ username: ..., user_id: ... }, ...], // Accounts that must be included in the list
 *     default : [{ username: ..., user_id: ... }, ...], // Accounts that will be suggested by default
 * });
 *
 * @description if "show_heatmap" is true, the "required" and "default" lists must include info and moderation_info
 *
 */
DuplicateAccountList.prototype.val = function( value ) {

    var dupes = this;

    if ( value ) {

        var multi = this.element.find('.multi:last-child');

        var primary_defined = false;

        var bb = this.show_heatmap ? this.bb : { user_posts: function() {} };

        function update_row(user) {
            var row = multi.clone()
                .insertBefore(multi)
                .data( 'user', user );
            row.find('.user').data( 'value', user.user_id );
            dupes.user_info[user.user_id] = {
                email: user.email,
                notes: user.notes,
                info: user.info,
                moderation_info: user.moderation_info,
                post_promise: bb.user_posts(user.user_id, true),
                note_promise: bb.user_notes(user.user_id),
            };
            dupes._set_row(row, user.username, user.user_id, value.required &amp;&amp; value.required[0] == user);
            if ( user.is_banned &amp;&amp; !primary_defined ) {
                row.find('[name="primary-username"]').prop( 'checked', true );
                primary_defined = true;
            }
            return row;
        }

        this.element.find('tbody > tr:not(:last-child)').remove();
        ( value.required || [] ).forEach(function(user) { update_row(user).addClass('required').find('.user').replaceWith($('&lt;span>').text(user.username.replace( /\s/g, '\u00A0' ))) });
        ( value.default  || [] ).forEach(function(user) { update_row(user)                     .find('.user')                        .val (user.username.replace( /\s/g, '\u00A0' ))  });
        if ( !primary_defined ) this.element.find('[name="primary-username"]').first().prop( 'checked', true );

    }

    return this.element.find('tr').map(function() { return $(this).data('dupe-account-val') }).get();

}

/**
 * Add a user to the list
 */
DuplicateAccountList.prototype._heatmap = function(container, info, post_list, notes) {

    var day_names = [ 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday' ];

    var heatmap = [];

    // heatmap consists only of posts:
    var max = 1;
    post_list.forEach(function(post) {
        var date = post.date;
        var day = heatmap[date.getUTCDay()];
        if ( !day ) day = heatmap[date.getUTCDay()] = [];

        if ( day[date.getUTCHours()] ) {
            max = Math.max( max, ++day[date.getUTCHours()] );
        } else {
            day[date.getUTCHours()] = 1;
        }
    });

    // build the heatmap from the posts:
    var map = '';
    for ( var d=0; d!=7; ++d ) {
        var day = heatmap[d];
        var day_name = day_names[d];
        if ( day ) {
            map += '&lt;div>'
            for ( var h=0; h!=24; ++h ) {
                var time_name = h + ':00-' + (h+1) + ':00';
                if ( day[h] ) {
                    var intensity = 255 - Math.ceil( 255 * day[h] / max );
                    map += '&lt;div class="posts" style="background: &lt;intensity=' + intensity + '>" title="' + day[h] + ' post(s) at ' + time_name + ' on a ' + day_name + '">&lt;/div>';
                } else {
                    map += '&lt;div class="no-posts" title="has never posted at ' + time_name + ' on a ' + day_name + '">&lt;/div>'
                }
            }
            map += '&lt;/div>';
        } else {
            map += '&lt;div title="(has never posted on a ' + day_name + ')">&lt;/div>'
        }
    }

    // build the event list for the user
    var username = info.username, posts = {}, infractions = [];

    var events = [
        { type: 'join'    , username: username, user_id: info.user_id, date: info.    join_date },
        { type: 'activity', username: username, user_id: info.user_id, date: info.activity_date }
    ];

    if ( post_list )
        post_list.forEach(function(post) {
            posts[post.id] = post;
            events.push({ type: 'post', username: username, target: post, date: post.date } );
        });

    if ( info.infractions )
        info.infractions.forEach(function(infraction) {
            events.push({ type: 'infraction', username: username, target: infraction, date: infraction.start_date });
        });

    if ( notes )
        notes.forEach(function(note) {
            events.push({ type: 'note', username: username, target: note, date: note.date_object });
        });

    var widget = this;
    $('&lt;a class="user-heatmap enabled" href="#show-hide-user">&lt;/a>')
        .appendTo(container.empty())
        .data( 'events', events )
        .click(function(event) {
            var $this = $(this);
            if ( $this.hasClass('enabled') ) {
                $this.removeClass('enabled').html(map.replace( /&lt;intensity=([0-9]*)>/g, 'rgb($1,$1,$1)'  ));
            } else {
                $this.   addClass('enabled').html(map.replace( /&lt;intensity=([0-9]*)>/g, 'rgb($1,$1,255)' ));
            }
            widget._heatmap_update();
            event.preventDefault();
        })
        .click();

}

DuplicateAccountList.prototype._heatmap_update = function() {

    var v = this.v, bb = this.bb;

    var events = [].concat.apply( [], this.element.find('.heatmap a.enabled').map(function() { return $(this).data('events') }).get() );
    events.sort(function(a,b) { return b.date &lt; a.date });

    var timeline = [];

    function event_info(event) {
        switch ( event.type ) {
        case 'infraction':
            var content = '&lt;span class="infraction">infraction&lt;/span>: ' + event.target.points + ' point(s) for ' + event.target.reason + '&lt;/div>';;
            if ( event.target.notes ) {
                console.log( 'infraction with notes', event.target.notes);
            };
            return {
                header  : content,
                body    : content,
                summary : event.target.reason + ' (' + event.target.points + ')',
                username: event.target.username,
                user_id : event.target.user_id
            };
        case 'post':
            return {
                header  : event.target.thread_title,
                body    : event.target.message,
                summary : bb.post_summary(event.target),
                username: event.target.username,
                user_id : event.target.user_id
            };
        case 'note':
            return {
                header  : '&lt;span class="note">Note&lt;/span>: ' + event.target.title,
                summary : bb.post_summary(event.target),
                body    : event.target.message,
                username: event.target.username,
                user_id : event.target.user_id
            };
        case 'join':
            return {
                header  : '&lt;span class="join">joined&lt;/span>',
                body    : 'First recorded activity for ' + event.username,
                summary : 'joined',
                username: event.username,
                user_id : event.user_id
            };
        case  'activity':
            return {
                header  : '&lt;span class="active">last activity&lt;/span>',
                body    : 'Most recent recorded activity for ' + event.username,
                summary : 'Most recent activity',
                username: event.username,
                user_id : event.user_id
            };
        default:
            return;
        }
    }

    function display_hour(hour_events, year, month, day, hour) {
        // Generate HTML to display all events that occurred this hour

        var event_types = {}, popup_body = $('&lt;ul>');
        hour_events.forEach(function(event) {
            if ( !event_types[event.type] ) event_types[event.type] = [];
            event_types[event.type].push(event);
            if ( event.type == 'nearby' ) {
                var event = events[event.event], info = event_info(event);
                if ( info )
                    $('&lt;li class="' + event.type + '">&lt;span>&lt;/span>&lt;a>&lt;/a>&lt;/li>').appendTo(popup_body)
                        .children('a')
                        .attr( 'href', location.toString().replace( /#.*/, '' ) + '#event-' + event.index )
                        .text( event.username + ': ' + info.summary );
            }
        });

        // if there is an infracted post at this time, act as if there is an infraction too:
        if ( !event_types.infraction &amp;&amp; ( event_types.post || [] ).filter(function(post) { return post.infraction }).length )
            event_types.infraction = [];

        var ret = $('&lt;a class="mod-team-events" href="#events-' + event_types.nearby.map(function(event) { return event.event }).join() + '">&lt;/a>');
        ret
            .attr( 'title', h+':00-'+(h+1)+':00, ' + (d+1) + ' ' + month_names[m] + ' ' + (2000+y) )
            .data( 'popup-body', popup_body )
        ;

        if      ( event_types.infraction ) ret.addClass('infraction');
        else if ( event_types.post       ) ret.addClass('post');
        else if ( event_types.note       ) ret.addClass('note');
        else if ( event_types.join       ) ret.addClass('join');
        else if ( event_types.activity   ) ret.addClass('active');

        return ret;
    }

    events.forEach(function(event, index) {
        var date = event.date;

        event.index = index;

        var min_offset = 0, max_offset=1;
        for ( var day_offset=min_offset; day_offset!=max_offset; ++day_offset )
            for ( var hour_offset=min_offset; hour_offset!=max_offset; ++hour_offset ) {
                var odate = new Date( date );
                odate.setDate ( odate.getDate () +  day_offset );
                odate.setHours( odate.getHours() + hour_offset );
                var node = timeline;
                [ odate.getUTCFullYear() - 2000, odate.getUTCMonth(), odate.getUTCDate()-1, odate.getUTCHours() ].forEach(function(index) {
                    if ( !node[index] ) node[index] = [];
                    node = node[index];
                });
                node.push({ type: 'nearby', event: index });
                if ( !day_offset &amp;&amp; !hour_offset ) node.push(event);
            }

    });

    var month_names = [ 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec' ];

    var cell_width = 4;

    var calendar = (
        this.element.find('.timeline')
            .data( 'events', events )
            .html( '&lt;div class="timeline-container">&lt;div class="user-timeline">&lt;/div>' )
            .find('.user-timeline')
    );
    var width = cell_width, started = false, now = new Date();
    for ( var y=0; y!=timeline.length; ++y ) {
        var year = timeline[y];
        if ( !year &amp;&amp; !started ) continue;
        started = true;
        var year_element = $('&lt;div>&lt;/div>').appendTo(calendar);
        for ( var m=0; m!=12; ++m ) {
            var date = new Date(2000+y, m+1, 0);
            if ( date > now ) break;
            var day_count = date.getDate();
            var month_element = $('&lt;div>&lt;span>' + month_names[m] + " '" + y + '&lt;/span>&lt;div class="month-marker">&lt;/div>&lt;/div>').appendTo(year_element);
            if ( year ) {
                var month = year[m];
                if ( month )
                    for ( var d=0; d!=day_count; ++d ) {
                        var day = month[d];
                        var day_element = $('&lt;div>&lt;/div>').appendTo(month_element);
                        if ( day )
                            for ( var h=0; h!=24; ++h ) {
                                var hour = day[h];
                                if ( hour )
                                    day_element.append(display_hour(hour, y, m, d, h));
                                else
                                    day_element.append('&lt;div>&lt;/div>');
                            }
                    }
            }
        }
    }

    var li_template = this.li_template, lis = [];

    events.forEach(function(event) {
        var info = event_info(event);
        if ( !info ) return;

        var li = li_template.clone().attr( 'id', 'event-' + event.index );
        li.find('.postdate').addClass('mod-friend-event-' + event.type);
        li.data( 'collapse', new Collapse({
            v : v,
            bb: bb,
            insertBefore: li.find('.postdate'),
            collapsed: true,
            callback: function() {
                li.toggleClass('mod-friend-collapsed')
            }
        }));
        li.find('time').attr( 'datetime', event.date ).text( event.date.toLocaleFormat().replace( /:00 /, ' ' ) );
        li.find('.username,.postuseravatar').attr( 'href', bb.url_for.user_show({ user_id: info.user_id }) );
        li.find('.username strong').text(info.username);
        li.find('.postuseravatar img').attr( 'src', bb.url_for.user_avatar({ user_id: info.user_id }) );
        li.find('.summary').text( event.username + ': ' + info.summary );
        li.find('h2').html(info.header);
        li.find('blockquote').html(info.body);

        lis.unshift(li);

    });

    this.element.find('#posts').empty().append(lis);

}
</code></pre>
        </article>
    </section>








        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-beta1</a> on 27 July 2015
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>
